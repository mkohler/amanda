.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "AMTOC" 8 "" "" ""
.SH NAME
amtoc \- generate TOC (Table Of Contents) for an AMANDA run
.SH "SYNOPSIS"
.ad l
.hy 0
.HP 6
\fBamtoc\fR [\-a] [\-i] [\-t] [\-f\ \fIfile\fR] [\-s\ \fIsubs\fR] [\-w] [\-\-] \fIlogfile\fR
.ad
.hy

.SH "DESCRIPTION"

.PP
\fBAmtoc\fR generates a table of contents for an \fBAMANDA\fR run\&. It's a perl script (if you don't have perl, install it first!)\&.

.SH "OPTIONS"

.TP
\fB\-a\fR
The output file name will be \fBlabel\-of\-the\-tape\fR\&.toc in the same directory as \fBlogfile\fR\&.

.TP
\fB\-i\fR
Display help about \fBamtoc\fR\&.

.TP
\fB\-t\fR
Generate the output in tabular form\&.

.TP
\fB\-f file\fR
Write the output to a file ('\-' for stdout)\&.

.TP
\fB\-s subs\fR
Evaluate the output file name from \fBsubs\fR, with $_ set to \fBlabel\-of\-the\-tape\fR\&. The \fB\-a\fR option is equivalent to \fB\-s\fR  \fI's/$_/\&.toc/'\fR\&.

.TP
\fB\-w\fR
Separate tapes with form\-feeds and display blank lines before totals\&.

.TP
\fB\-\-\fR
Marks the last option so the next parameter is the \fBlogfile\fR\&.

.TP
\fBlogfile\fR
(use '\-' for stdin)

.SH "OUTPUT FORMAT"

.PP
The standard output has five fields separated by two spaces:

.nf

#  Server:/partition  date  level  size[Kb]
0  daily\-05:  19991005  \-  \-
1  cuisun15:/cuisun15/home  19991005  1  96
2  cuinfs:/export/dentiste  19991005  1  96
  \&.\&.\&.
103  cuisg11:/  19991005  0  4139136
103  total:  \-  \-  16716288



.fi

.PP
In tabular format (\-t), this would look like:

.nf

  #  Server:/partition           date      lev  size[Kb]
  0  daily\-05:                   19991005    \-         \-
  1  cuisun15:/cuisun15/home     19991005    1        96
  2  cuinfs:/export/dentiste     19991005    1        96
  \&.\&.\&.
103  cuisg11:/                   19991005    0   4139136
103  total:                      \-           \-  16716288


.fi

.SH "USAGE"

.PP
The easiest way to use it is to run \fBamtoc\fR right after \fBamdump\fR in the \fBcron job:\fR

.nf

amdump daily ; logdir=`amgetconf daily logdir` ; log=`ls \-1t $logdir/log\&.*\&.[0\-9] | head \-1` ; amtoc \-a $log

.fi

.PP
which will generate /usr/local/etc/amanda//daily/\fBtape_label\fR\&.toc\&. You may also want to call \fBamtoc\fR after an \fBamflush\fR\&.

.SH "SEE ALSO"

.PP
\fBamanda\fR(8), \fBamdump\fR(8), \fBamflush\fR(8), \fBamgetconf\fR(8), cron, perl

.SH "AUTHOR"

.PP
Nicolas Mayencourt <Nicolas\&.Mayencourt@cui\&.unige\&.ch>, University of Geneva/Switzerland : Original text

.PP
Stefan G\&. Weichinger, <sgw@amanda\&.org>, maintainer of the \fBAMANDA\fR\-documentation: XML\-conversion

