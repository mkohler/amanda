.\"
.de CO
\fB\\$1\fP \fI\\$2\fP
..
.TH AMTAPE 8
.SH NAME
amtape \- user interface to Amanda tape changer controls
.SH SYNOPSIS
.B amtape
.I config
.I command
[
.I command options
]
.SH DESCRIPTION
.B Amtape
performs tape changer control operations.
It uses the underlying tape changer script defined by the
.B tpchanger
option for a particular Amanda
configuration as specified by the
.I config
argument.
.LP
Tape changers maintain a notion of the
.I current
and
.I next
slot for each configuration.
These may or may not correspond to an actual physical state of the device,
but do tend to minimize searching through the tape storage slots.
If the desired tape is in the current slot,
it is likely the next tape needed is in the next slot
rather than at some random position in the storage slots.
.LP
See the
.IR amanda (8)
man page for more details about Amanda.
.SH COMMANDS
.TP
.B reset
Reset the tape changer to a known state.
The
.I current
slot is set to the
.I first
slot.
Other device-specific side effects may occur.
Some gravity stackers need to be reset to the top position by hand.
This command notifies Amanda the stacker is back in that position.
.TP
.B eject
If a tape is loaded in the drive, it is ejected and returned to the
slot from which it was loaded.
.TP
.B clean
If a cleaning tape is defined for the changer,
it is used to clean the drive.
.TP
.B show
Show the contents of all slots.
This can be slow.
.TP
.CO label label
Search for and load the Amanda tape with label
.IR label .
.TP
.B taper
Perform the
.B taper
scan algorithm.
Load the next tape in the configuration's tape sequence,
or a fresh tape with a suitable label.
.TP
.B device
Display the name of the current tape device on
.IR stdout .
.TP
.B current
Display the current slot.
.TP
.B update
Update the changer label database, if it has one,
to match the tapes now available.
.TP
.CO slot slot
Eject any tape in the drive and put it away,
then load the tape from slot
.I slot
and reset
.IR current .
.TP
.B slot current
Eject any tape in the drive and put it away,
then load the tape from the current slot.
.TP
.B slot prev
Eject any tape in the drive and put it away,
then load the tape from the previous slot and reset
.IR current .
.TP
.B slot next
Eject any tape in the drive and put it away,
then load the tape from the next slot and reset
.IR current .
.TP
.B slot first
Eject any tape in the drive and put it away,
then load the tape from the first slot and reset
.IR current .
.TP
.B slot last
Eject any tape in the drive and put it away,
then load the tape from the last slot and reset
.IR current .
.TP
.B slot advance
Eject any tape in the drive and put it away.
Advance
.I current
to the next tape, but do not load it.
.IP
This is useful with non-gravity stackers to unload the last tape used
and set up Amanda for the next run.
If you just use
.BR eject ,
the current tape will be mounted again in the next run,
where it will be rejected as being still in use,
ejected and the next tape requested.
Using
.B slot next
followed by
.B eject
does an unnecessary mount.
.LP
Note: most changers optimize the
.B slot
commands to not eject the loaded tape if it is the one being requested.
.SH AUTHOR
James da Silva <jds@cs.umd.edu>
.br
University of Maryland, College Park
.SH "SEE ALSO"
amanda(8)
